code dublication spread across 3 different files

